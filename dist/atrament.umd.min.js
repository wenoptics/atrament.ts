!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.atrament=e():t.atrament=e()}(window,(function(){return function(t){var e={};function s(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(i,o,function(e){return t[e]}.bind(null,o));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){t.exports=s(1)},function(t,e,s){"use strict";s.r(e);class i{constructor(t,e){this.x=t,this.y=e}set(t,e){this.x=t,this.y=e}}class o extends i{constructor(){super(0,0),this.down=!1,this.previous=new i(0,0)}}const n=100,r=1,h=50-r,a=.5,c=.87,d=.85,u=10,l=2;function f(t,e,s,i){const o=Math.pow(s-t,2),n=Math.pow(i-e,2);return Math.sqrt(o+n)}function m(t,e,s,i,o){return n=>{const r=t[n],h=t[n+1],a=t[n+2],c=t[n+3];return r===e&&h===s&&a===i&&c===o}}class v{constructor(){this.eventListeners=new Map}addEventListener(t,e){const s=this.eventListeners.get(t)||new Set;s.add(e),this.eventListeners.set(t,s)}removeEventListener(t,e){const s=this.eventListeners.get(t);s&&s.delete(e)}dispatchEvent(t,e){const s=this.eventListeners.get(t);s&&s.forEach(t=>t(e))}}function p(t,e){for(let s=0;s<t.length;s++)if(t[s]===e)return!0;return!1}function g(t,e){const s="changedTouches"in t&&t.changedTouches[0]||t;return{x:"offsetX"in s?s.offsetX:s.clientX-e.left,y:"offsetY"in s?s.offsetY:s.clientY-e.top}}var w;!function(t){t.DRAW="draw",t.ERASE="erase",t.FILL="fill",t.DISABLED="disabled"}(w||(w={}));const y=[w.DRAW,w.ERASE];class x extends v{constructor(t,e={}){if("undefined"==typeof window)throw new Error("Looks like we're not running in a browser");if(super(),t instanceof window.Node&&"CANVAS"===t.tagName)this.canvas=t;else{if("string"!=typeof t)throw new Error(`can't look for canvas based on '${t}'`);this.canvas=document.querySelector(t)}if(!this.canvas)throw new Error("canvas not found");this.canvas.width=e.width||this.canvas.width,this.canvas.height=e.height||this.canvas.height,this.mouse=new o;const s=t=>{t.cancelable&&t.preventDefault();const e=this.canvas.getBoundingClientRect(),{x:s,y:i}=g(t,e),{mouse:o}=this;if(o.down&&p(y,this.mode)){const{x:t,y:e}=this.draw(s,i,o.previous.x,o.previous.y);this._dirty||this.mode!==w.DRAW||s===o.x&&i===o.y||(this._dirty=!0,this.fireDirty()),o.set(s,i),o.previous.set(t,e)}else o.set(s,i)},i=t=>{if(t.cancelable&&t.preventDefault(),s(t),this.mode===w.FILL)return void this.fill();const{mouse:e}=this;e.previous.set(e.x,e.y),e.down=!0,this.beginStroke(e.previous.x,e.previous.y)},n=t=>{if(this.mode===w.FILL)return;const{mouse:e}=this;if(!e.down)return;const s=this.canvas.getBoundingClientRect(),{x:i,y:o}=g(t,s);if(e.down=!1,e.x===i&&e.y===o&&p(y,this.mode)){const{x:t,y:s}=this.draw(e.x,e.y,e.previous.x,e.previous.y);e.previous.set(t,s)}this.endStroke(e.x,e.y)};this.canvas.addEventListener("mousemove",s),this.canvas.addEventListener("mousedown",i),document.addEventListener("mouseup",n),this.canvas.addEventListener("touchstart",i),this.canvas.addEventListener("touchend",n),this.canvas.addEventListener("touchmove",s),this.destroy=()=>{this.clear(),this.canvas.removeEventListener("mousemove",s),this.canvas.removeEventListener("mousedown",i),document.removeEventListener("mouseup",n),this.canvas.removeEventListener("touchstart",i),this.canvas.removeEventListener("touchend",n),this.canvas.removeEventListener("touchmove",s)},this.context=this.canvas.getContext("2d"),this.context.globalCompositeOperation="source-over",this.context.globalAlpha=1,this.context.strokeStyle=e.color||"rgba(0,0,0,1)",this.context.lineCap="round",this.context.lineJoin="round",this.context.translate(.5,.5),this._filling=!1,this._fillStack=[],this.recordStrokes=!1,this.strokeMemory=[],this.smoothing=d,this._thickness=l,this._targetThickness=this._thickness,this._weight=this._thickness,this._maxWeight=this._thickness+u,this._mode=w.DRAW,this.adaptiveStroke=!0,void 0!==e.weight&&(this.weight=e.weight),void 0!==e.smoothing&&(this.smoothing=e.smoothing),void 0!==e.adaptiveStroke&&(this.adaptiveStroke=e.adaptiveStroke),void 0!==e.mode&&(this.mode=e.mode)}beginStroke(t,e){this.context.beginPath(),this.context.moveTo(t,e),this.recordStrokes&&(this.strokeTimestamp=performance.now(),this.strokeMemory.push({point:new i(t,e),time:performance.now()-this.strokeTimestamp})),this.dispatchEvent("strokestart",{x:t,y:e})}endStroke(t,e){if(this.context.closePath(),this.recordStrokes&&this.strokeMemory.push({point:new i(t,e),time:performance.now()-this.strokeTimestamp}),this.dispatchEvent("strokeend",{x:t,y:e}),this.recordStrokes){const t={points:this.strokeMemory.slice(),mode:this.mode,weight:this.weight,smoothing:this.smoothing,color:this.color,adaptiveStroke:this.adaptiveStroke};this.dispatchEvent("strokerecorded",{stroke:t})}this.strokeMemory=[],delete this.strokeTimestamp}draw(t,e,s,o){this.recordStrokes&&this.strokeMemory.push({point:new i(t,e),time:performance.now()-this.strokeTimestamp});const{context:n}=this,d=f(t,e,s,o),u=Math.min(c,this.smoothing+(d-60)/3e3),l=t-(t-s)*u,m=e-(e-o)*u,v=f(l,m,s,o);return this.adaptiveStroke?(this._targetThickness=(v-r)/h*(this._maxWeight-this._weight)+this._weight,this._thickness>this._targetThickness?this._thickness-=a:this._thickness<this._targetThickness&&(this._thickness+=a),n.lineWidth=this._thickness):n.lineWidth=this._weight,n.quadraticCurveTo(s,o,l,m),n.stroke(),{x:l,y:m}}get color(){return this.context.strokeStyle.toString()}set color(t){if("string"!=typeof t)throw new Error("wrong argument type");this.context.strokeStyle=t}get weight(){return this._weight}set weight(t){if("number"!=typeof t)throw new Error("wrong argument type");this._weight=t,this._thickness=t,this._targetThickness=t,this._maxWeight=t+u}get mode(){return this._mode}set mode(t){if("string"!=typeof t)throw new Error("wrong argument type");switch(t){case w.ERASE:this._mode=w.ERASE,this.context.globalCompositeOperation="destination-out";break;case w.FILL:this._mode=w.FILL,this.context.globalCompositeOperation="source-over";break;case w.DISABLED:this._mode=w.DISABLED;break;default:this._mode=w.DRAW,this.context.globalCompositeOperation="source-over"}}isDirty(){return!!this._dirty}fireDirty(){this.dispatchEvent("dirty")}clear(){this.isDirty&&(this._dirty=!1,this.dispatchEvent("clean"),this.mode===w.ERASE?(this.mode=w.DRAW,this.context.clearRect(-10,-10,this.canvas.width+20,this.canvas.height+20),this.mode=w.ERASE):this.context.clearRect(-10,-10,this.canvas.width+20,this.canvas.height+20))}toImage(){return this.canvas.toDataURL()}fill(){const{mouse:t}=this,{context:e}=this,s=Array.from(e.getImageData(t.x,t.y,1,1).data);if(4!==s.length)throw new Error("Expect pixel format of RGBA");if(this._filling)this._fillStack.push([t.x,t.y,s]);else{const{x:e,y:i}=t;this.dispatchEvent("fillstart",{x:e,y:i}),this._filling=!0,setTimeout(()=>{this._floodFill(t.x,t.y,s)},n)}}_floodFill(t,e,s){const{context:i}=this,o=Math.floor(t),n=Math.floor(e),r=i.canvas.width,h=i.canvas.height,a=[[o,n]],c=function(t){const e=t.match(/^#?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i);return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}(this.color),d=i.getImageData(0,0,i.canvas.width,i.canvas.height),u=Array.from(d.data),l=Math.min(10*i.globalAlpha*255,255),f=function(t,e,s,i,o,n){const r=m(t,...o);return o=>{t[o]=e,t[o+1]=s,t[o+2]=i,t[o+3]=n,r(o+4)||(t[o+4]=.01*t[o+4]+.99*e,t[o+4+1]=.01*t[o+4+1]+.99*s,t[o+4+2]=.01*t[o+4+2]+.99*i,t[o+4+3]=.01*t[o+4+3]+.99*n),r(o-4)||(t[o-4]=.01*t[o-4]+.99*e,t[o-4+1]=.01*t[o-4+1]+.99*s,t[o-4+2]=.01*t[o-4+2]+.99*i,t[o-4+3]=.01*t[o-4+3]+.99*n)}}(u,...c,s,l),v=m(u,...s);if(m(u,...c,255)(4*(n*i.canvas.width+o)))return this._filling=!1,void this.dispatchEvent("fillend",{});for(;a.length;){const t=a.pop(),e=t[0];let s=t[1],i=4*(s*r+e);for(;s-- >=0&&v(i);)i-=4*r;i+=4*r,++s;let o=!1,n=!1;for(;s++<h-1&&v(i);)f(i),e>0&&(v(i-4)?o||(a.push([e-1,s]),o=!0):o&&(o=!1)),e<r-1&&(v(i+4)?n||(a.push([e+1,s]),n=!0):n&&(n=!1)),i+=4*r}i.putImageData(d,0,0),this._fillStack.length?this._floodFill(...this._fillStack.shift()):(this._filling=!1,this.dispatchEvent("fillend",{}))}}s.d(e,"Atrament",(function(){return x}))}])}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hdHJhbWVudC93ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCJ3ZWJwYWNrOi8vYXRyYW1lbnQvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vYXRyYW1lbnQvLi9zcmMvbW91c2UudHMiLCJ3ZWJwYWNrOi8vYXRyYW1lbnQvLi9zcmMvY29uc3RhbnRzLnRzIiwid2VicGFjazovL2F0cmFtZW50Ly4vc3JjL3BpeGVscy50cyIsIndlYnBhY2s6Ly9hdHJhbWVudC8uL3NyYy9ldmVudHMudHMiLCJ3ZWJwYWNrOi8vYXRyYW1lbnQvLi9zcmMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vYXRyYW1lbnQvLi9zcmMvYXRyYW1lbnQudHMiLCJ3ZWJwYWNrOi8vYXRyYW1lbnQvLi9pbmRleC50cyJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJ3aW5kb3ciLCJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiUG9pbnQiLCJ4IiwieSIsInRoaXMiLCJNb3VzZSIsInN1cGVyIiwiZG93biIsInByZXZpb3VzIiwiZmxvb2RGaWxsSW50ZXJ2YWwiLCJtaW5MaW5lVGhpY2tuZXNzIiwibGluZVRoaWNrbmVzc1JhbmdlIiwidGhpY2tuZXNzSW5jcmVtZW50IiwibWluU21vb3RoaW5nRmFjdG9yIiwiaW5pdGlhbFNtb290aGluZ0ZhY3RvciIsIndlaWdodFNwcmVhZCIsImluaXRpYWxUaGlja25lc3MiLCJsaW5lRGlzdGFuY2UiLCJ4MSIsInkxIiwieDIiLCJ5MiIsInhzIiwiTWF0aCIsInBvdyIsInlzIiwic3FydCIsImRhdGEiLCJjb21wUiIsImNvbXBHIiwiY29tcEIiLCJjb21wQSIsInBpeGVsUG9zIiwiZyIsImIiLCJhIiwiQXRyYW1lbnRFdmVudFRhcmdldCIsImV2ZW50TGlzdGVuZXJzIiwiTWFwIiwiZXZlbnROYW1lIiwiaGFuZGxlciIsImhhbmRsZXJzIiwiU2V0IiwiYWRkIiwic2V0IiwiZGVsZXRlIiwiZm9yRWFjaCIsImluY2x1ZGVzIiwiYXJyIiwiZWxlbWVudCIsImxlbmd0aCIsInVucGFja09mZnNldFhZIiwiZXZlbnQiLCJyZWN0IiwicG9zaXRpb24iLCJjaGFuZ2VkVG91Y2hlcyIsIm9mZnNldFgiLCJjbGllbnRYIiwibGVmdCIsIm9mZnNldFkiLCJjbGllbnRZIiwidG9wIiwiRHJhd2luZ01vZGUiLCJQYXRoRHJhd2luZ01vZGVzIiwiRFJBVyIsIkVSQVNFIiwic2VsZWN0b3IiLCJjb25maWciLCJFcnJvciIsIk5vZGUiLCJ0YWdOYW1lIiwiY2FudmFzIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwid2lkdGgiLCJoZWlnaHQiLCJtb3VzZSIsIm1vdXNlTW92ZSIsImNhbmNlbGFibGUiLCJwcmV2ZW50RGVmYXVsdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIm5ld1giLCJuZXdZIiwiZHJhdyIsIl9kaXJ0eSIsImZpcmVEaXJ0eSIsIm1vdXNlRG93biIsIkZJTEwiLCJmaWxsIiwiYmVnaW5TdHJva2UiLCJtb3VzZVVwIiwibngiLCJueSIsImVuZFN0cm9rZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJkZXN0cm95IiwiY2xlYXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiY29udGV4dCIsImdldENvbnRleHQiLCJnbG9iYWxDb21wb3NpdGVPcGVyYXRpb24iLCJnbG9iYWxBbHBoYSIsInN0cm9rZVN0eWxlIiwiY29sb3IiLCJsaW5lQ2FwIiwibGluZUpvaW4iLCJ0cmFuc2xhdGUiLCJfZmlsbGluZyIsIl9maWxsU3RhY2siLCJyZWNvcmRTdHJva2VzIiwic3Ryb2tlTWVtb3J5Iiwic21vb3RoaW5nIiwiX3RoaWNrbmVzcyIsIl90YXJnZXRUaGlja25lc3MiLCJfd2VpZ2h0IiwiX21heFdlaWdodCIsIl9tb2RlIiwiYWRhcHRpdmVTdHJva2UiLCJ1bmRlZmluZWQiLCJ3ZWlnaHQiLCJiZWdpblBhdGgiLCJtb3ZlVG8iLCJzdHJva2VUaW1lc3RhbXAiLCJwZXJmb3JtYW5jZSIsIm5vdyIsInB1c2giLCJwb2ludCIsInRpbWUiLCJkaXNwYXRjaEV2ZW50IiwiY2xvc2VQYXRoIiwic3Ryb2tlIiwicG9pbnRzIiwic2xpY2UiLCJwcmV2WCIsInByZXZZIiwicmF3RGlzdCIsInNtb290aGluZ0ZhY3RvciIsIm1pbiIsInByb2NYIiwicHJvY1kiLCJkaXN0IiwibGluZVdpZHRoIiwicXVhZHJhdGljQ3VydmVUbyIsInRvU3RyaW5nIiwidyIsIkRJU0FCTEVEIiwiaXNEaXJ0eSIsImNsZWFyUmVjdCIsInRvRGF0YVVSTCIsInN0YXJ0Q29sb3IiLCJBcnJheSIsImZyb20iLCJnZXRJbWFnZURhdGEiLCJzZXRUaW1lb3V0IiwiX2Zsb29kRmlsbCIsIl9zdGFydFgiLCJfc3RhcnRZIiwic3RhcnRYIiwiZmxvb3IiLCJzdGFydFkiLCJjYW52YXNXaWR0aCIsImNhbnZhc0hlaWdodCIsInBpeGVsU3RhY2siLCJmaWxsQ29sb3IiLCJoZXhDb2xvciIsIm1hdGNoIiwicGFyc2VJbnQiLCJjb2xvckxheWVyIiwiY29sb3JMYXllckRhdGEiLCJhbHBoYSIsImNvbG9yUGl4ZWwiLCJmaWxsUiIsImZpbGxHIiwiZmlsbEIiLCJtYXRjaGVyIiwibWF0Y2hDb2xvciIsIm1hdGNoRmlsbENvbG9yIiwibmV3UG9zIiwicG9wIiwicmVhY2hMZWZ0IiwicmVhY2hSaWdodCIsInB1dEltYWdlRGF0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VyxJQUloQyxLQUFPa0MsRUFBV2hILFFBQVEsQ0FDeEIsTUFBTStILEVBQVNmLEVBQVdnQixNQUNwQmhMLEVBQUkrSyxFQUFPLEdBQ2pCLElBQUk5SyxFQUFJOEssRUFBTyxHQUVYakosRUFBbUMsR0FBdkI3QixFQUFJNkosRUFBYzlKLEdBRWxDLEtBQU9DLE1BQU8sR0FBSzRLLEVBQVcvSSxJQUM1QkEsR0FBMEIsRUFBZGdJLEVBRWRoSSxHQUEwQixFQUFkZ0ksSUFFVjdKLEVBRUYsSUFBSWdMLEdBQVksRUFDWkMsR0FBYSxFQUVqQixLQUFPakwsSUFBTThKLEVBQWUsR0FBS2MsRUFBVy9JLElBQzFDMEksRUFBVzFJLEdBRVA5QixFQUFJLElBQ0Y2SyxFQUFXL0ksRUFBVyxHQUNuQm1KLElBQ0hqQixFQUFXckMsS0FBSyxDQUFDM0gsRUFBSSxFQUFHQyxJQUN4QmdMLEdBQVksR0FHUEEsSUFDUEEsR0FBWSxJQUlaakwsRUFBSThKLEVBQWMsSUFDaEJlLEVBQVcvSSxFQUFXLEdBQ25Cb0osSUFDSGxCLEVBQVdyQyxLQUFLLENBQUMzSCxFQUFJLEVBQUdDLElBQ3hCaUwsR0FBYSxHQUdSQSxJQUNQQSxHQUFhLElBSWpCcEosR0FBMEIsRUFBZGdJLEVBS2hCOUQsRUFBUW1GLGFBQWFkLEVBQVksRUFBRyxHQUVoQ25LLEtBQUt3RyxXQUFXMUQsT0FDbEI5QyxLQUFLc0osY0FBY3RKLEtBQUt3RyxXQUFXMEUsVUFHbkNsTCxLQUFLdUcsVUFBVyxFQUNoQnZHLEtBQUs0SCxjQUFjLFVBQVcsTUN2ZXBDIiwiZmlsZSI6ImF0cmFtZW50LnVtZC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJhdHJhbWVudFwiXSA9IGZhY3RvcnkoKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJhdHJhbWVudFwiXSA9IGZhY3RvcnkoKTtcbn0pKHdpbmRvdywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiLy8gbWFrZSBhIGNsYXNzIGZvciBQb2ludFxuY2xhc3MgUG9pbnQge1xuICB4OiBudW1iZXI7XG5cbiAgeTogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKHg6IG51bWJlciwgeTogbnVtYmVyKSB7XG4gICAgdGhpcy54ID0geDtcbiAgICB0aGlzLnkgPSB5O1xuICB9XG5cbiAgc2V0KHg6IG51bWJlciwgeTogbnVtYmVyKSB7XG4gICAgdGhpcy54ID0geDtcbiAgICB0aGlzLnkgPSB5O1xuICB9XG59XG5cbi8vIG1ha2UgYSBjbGFzcyBmb3IgdGhlIG1vdXNlIGRhdGFcbmNsYXNzIE1vdXNlIGV4dGVuZHMgUG9pbnQge1xuXG4gIGRvd246IGJvb2xlYW47XG5cbiAgcHJldmlvdXM6IFBvaW50O1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKDAsIDApO1xuICAgIHRoaXMuZG93biA9IGZhbHNlO1xuICAgIHRoaXMucHJldmlvdXMgPSBuZXcgUG9pbnQoMCwgMCk7XG4gIH1cbn1cblxuZXhwb3J0IHsgTW91c2UsIFBvaW50IH07XG4iLCJleHBvcnQgY29uc3QgZmxvb2RGaWxsSW50ZXJ2YWwgPSAxMDA7XG5leHBvcnQgY29uc3QgbWF4TGluZVRoaWNrbmVzcyA9IDUwO1xuZXhwb3J0IGNvbnN0IG1pbkxpbmVUaGlja25lc3MgPSAxO1xuZXhwb3J0IGNvbnN0IGxpbmVUaGlja25lc3NSYW5nZSA9IG1heExpbmVUaGlja25lc3MgLSBtaW5MaW5lVGhpY2tuZXNzO1xuZXhwb3J0IGNvbnN0IHRoaWNrbmVzc0luY3JlbWVudCA9IDAuNTtcbmV4cG9ydCBjb25zdCBtaW5TbW9vdGhpbmdGYWN0b3IgPSAwLjg3O1xuZXhwb3J0IGNvbnN0IGluaXRpYWxTbW9vdGhpbmdGYWN0b3IgPSAwLjg1O1xuZXhwb3J0IGNvbnN0IHdlaWdodFNwcmVhZCA9IDEwO1xuZXhwb3J0IGNvbnN0IGluaXRpYWxUaGlja25lc3MgPSAyO1xuIiwiZXhwb3J0IHR5cGUgQ29sb3JQaXhlbFJHQkEgPSBbbnVtYmVyLCBudW1iZXIsIG51bWJlciwgbnVtYmVyXVxuZXhwb3J0IHR5cGUgQ29sb3JQaXhlbFJHQiA9IFtudW1iZXIsIG51bWJlciwgbnVtYmVyXVxuXG5leHBvcnQgZnVuY3Rpb24gbGluZURpc3RhbmNlICh4MTogbnVtYmVyLCB5MTogbnVtYmVyLCB4MjogbnVtYmVyLCB5MjogbnVtYmVyKSB7XG4gIC8vIGNhbGN1bGF0ZSBldWNsaWRlYW4gZGlzdGFuY2UgYmV0d2VlbiAoeDEsIHkxKSBhbmQgKHgyLCB5MilcbiAgY29uc3QgeHMgPSBNYXRoLnBvdyh4MiAtIHgxLCAyKTtcbiAgY29uc3QgeXMgPSBNYXRoLnBvdyh5MiAtIHkxLCAyKTtcbiAgcmV0dXJuIE1hdGguc3FydCh4cyArIHlzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhleFRvUmdiIChoZXhDb2xvcjogc3RyaW5nKTogQ29sb3JQaXhlbFJHQiB7XG4gIC8vIFNpbmNlIGlucHV0IHR5cGUgY29sb3IgcHJvdmlkZXMgaGV4IGFuZCBJbWFnZURhdGEgYWNjZXB0cyBSR0IgbmVlZCB0byB0cmFuc2Zvcm1cbiAgY29uc3QgbSA9IGhleENvbG9yLm1hdGNoKC9eIz8oW1xcZGEtZl17Mn0pKFtcXGRhLWZdezJ9KShbXFxkYS1mXXsyfSkkL2kpO1xuICByZXR1cm4gW1xuICAgIHBhcnNlSW50KG1bMV0sIDE2KSxcbiAgICBwYXJzZUludChtWzJdLCAxNiksXG4gICAgcGFyc2VJbnQobVszXSwgMTYpXG4gIF07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYXRjaENvbG9yIChkYXRhOiBudW1iZXJbXSwgY29tcFI6IG51bWJlciwgY29tcEc6IG51bWJlciwgY29tcEI6IG51bWJlciwgY29tcEE6IG51bWJlcikge1xuICByZXR1cm4gKHBpeGVsUG9zOiBudW1iZXIpID0+IHtcbiAgICAvLyBQaXhlbCBjb2xvciBlcXVhbHMgY29tcCBjb2xvcj9cbiAgICBjb25zdCByID0gZGF0YVtwaXhlbFBvc107XG4gICAgY29uc3QgZyA9IGRhdGFbcGl4ZWxQb3MgKyAxXTtcbiAgICBjb25zdCBiID0gZGF0YVtwaXhlbFBvcyArIDJdO1xuICAgIGNvbnN0IGEgPSBkYXRhW3BpeGVsUG9zICsgM107XG5cbiAgICByZXR1cm4gKHIgPT09IGNvbXBSICYmIGcgPT09IGNvbXBHICYmIGIgPT09IGNvbXBCICYmIGEgPT09IGNvbXBBKTtcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbG9yUGl4ZWwgKGRhdGE6IG51bWJlcltdLCBmaWxsUjogbnVtYmVyLCBmaWxsRzogbnVtYmVyLCBmaWxsQjogbnVtYmVyLCBzdGFydENvbG9yOiBDb2xvclBpeGVsUkdCQSwgYWxwaGE6IG51bWJlcikge1xuICBjb25zdCBtYXRjaGVyID0gbWF0Y2hDb2xvcihkYXRhLCAuLi5zdGFydENvbG9yKTtcblxuICByZXR1cm4gKHBpeGVsUG9zOiBudW1iZXIpID0+IHtcbiAgICAvLyBVcGRhdGUgZmlsbCBjb2xvciBpbiBtYXRyaXhcbiAgICBkYXRhW3BpeGVsUG9zXSA9IGZpbGxSO1xuICAgIGRhdGFbcGl4ZWxQb3MgKyAxXSA9IGZpbGxHO1xuICAgIGRhdGFbcGl4ZWxQb3MgKyAyXSA9IGZpbGxCO1xuICAgIGRhdGFbcGl4ZWxQb3MgKyAzXSA9IGFscGhhO1xuXG4gICAgaWYgKCFtYXRjaGVyKHBpeGVsUG9zICsgNCkpIHtcbiAgICAgIGRhdGFbcGl4ZWxQb3MgKyA0XSA9IGRhdGFbcGl4ZWxQb3MgKyA0XSAqIDAuMDEgKyBmaWxsUiAqIDAuOTk7XG4gICAgICBkYXRhW3BpeGVsUG9zICsgNCArIDFdID0gZGF0YVtwaXhlbFBvcyArIDQgKyAxXSAqIDAuMDEgKyBmaWxsRyAqIDAuOTk7XG4gICAgICBkYXRhW3BpeGVsUG9zICsgNCArIDJdID0gZGF0YVtwaXhlbFBvcyArIDQgKyAyXSAqIDAuMDEgKyBmaWxsQiAqIDAuOTk7XG4gICAgICBkYXRhW3BpeGVsUG9zICsgNCArIDNdID0gZGF0YVtwaXhlbFBvcyArIDQgKyAzXSAqIDAuMDEgKyBhbHBoYSAqIDAuOTk7XG4gICAgfVxuXG4gICAgaWYgKCFtYXRjaGVyKHBpeGVsUG9zIC0gNCkpIHtcbiAgICAgIGRhdGFbcGl4ZWxQb3MgLSA0XSA9IGRhdGFbcGl4ZWxQb3MgLSA0XSAqIDAuMDEgKyBmaWxsUiAqIDAuOTk7XG4gICAgICBkYXRhW3BpeGVsUG9zIC0gNCArIDFdID0gZGF0YVtwaXhlbFBvcyAtIDQgKyAxXSAqIDAuMDEgKyBmaWxsRyAqIDAuOTk7XG4gICAgICBkYXRhW3BpeGVsUG9zIC0gNCArIDJdID0gZGF0YVtwaXhlbFBvcyAtIDQgKyAyXSAqIDAuMDEgKyBmaWxsQiAqIDAuOTk7XG4gICAgICBkYXRhW3BpeGVsUG9zIC0gNCArIDNdID0gZGF0YVtwaXhlbFBvcyAtIDQgKyAzXSAqIDAuMDEgKyBhbHBoYSAqIDAuOTk7XG4gICAgfVxuICB9O1xufVxuIiwidHlwZSBFdmVudEhhbmRsZXI8VD4gPSAoZGF0YT86IFQpID0+IHZvaWRcblxuY2xhc3MgQXRyYW1lbnRFdmVudFRhcmdldCB7XG5cbiAgZXZlbnRMaXN0ZW5lcnM6IE1hcDxzdHJpbmcsIFNldDxFdmVudEhhbmRsZXI8dW5rbm93bj4+PjtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmV2ZW50TGlzdGVuZXJzID0gbmV3IE1hcCgpO1xuICB9XG5cbiAgYWRkRXZlbnRMaXN0ZW5lcjxUPihldmVudE5hbWU6IHN0cmluZywgaGFuZGxlcjogRXZlbnRIYW5kbGVyPFQ+KSB7XG4gICAgY29uc3QgaGFuZGxlcnMgPSB0aGlzLmV2ZW50TGlzdGVuZXJzLmdldChldmVudE5hbWUpIHx8IG5ldyBTZXQoKTtcbiAgICBoYW5kbGVycy5hZGQoaGFuZGxlcik7XG4gICAgdGhpcy5ldmVudExpc3RlbmVycy5zZXQoZXZlbnROYW1lLCBoYW5kbGVycyk7XG4gIH1cblxuICByZW1vdmVFdmVudExpc3RlbmVyPFQ+KGV2ZW50TmFtZTogc3RyaW5nLCBoYW5kbGVyOiBFdmVudEhhbmRsZXI8VD4pIHtcbiAgICBjb25zdCBoYW5kbGVycyA9IHRoaXMuZXZlbnRMaXN0ZW5lcnMuZ2V0KGV2ZW50TmFtZSk7XG4gICAgaWYgKCFoYW5kbGVycykgcmV0dXJuO1xuICAgIGhhbmRsZXJzLmRlbGV0ZShoYW5kbGVyKTtcbiAgfVxuXG4gIGRpc3BhdGNoRXZlbnQ8VD4gKGV2ZW50TmFtZTogc3RyaW5nLCBkYXRhPzogVCkge1xuICAgIGNvbnN0IGhhbmRsZXJzID0gdGhpcy5ldmVudExpc3RlbmVycy5nZXQoZXZlbnROYW1lKTtcbiAgICBpZiAoIWhhbmRsZXJzKSByZXR1cm47XG4gICAgaGFuZGxlcnMuZm9yRWFjaChoYW5kbGVyID0+IGhhbmRsZXIoZGF0YSkpO1xuICB9XG59XG5cbmV4cG9ydCB7IEF0cmFtZW50RXZlbnRUYXJnZXQgfTtcbiIsImV4cG9ydCBmdW5jdGlvbiBpbmNsdWRlczxUPihhcnI6IEFycmF5PFQ+LCBlbGVtZW50OiBUKSB7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKGFycltpXSA9PT0gZWxlbWVudCkgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdW5wYWNrT2Zmc2V0WFkoZXZlbnQ6IE1vdXNlRXZlbnQgfCBUb3VjaEV2ZW50LCByZWN0OiBET01SZWN0KSB7XG4gIGNvbnN0IHBvc2l0aW9uID0gKCdjaGFuZ2VkVG91Y2hlcycgaW4gZXZlbnQpICYmIGV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdIHx8IGV2ZW50IGFzIE1vdXNlRXZlbnQ7XG4gIGNvbnN0IHggPSAnb2Zmc2V0WCcgaW4gcG9zaXRpb24gPyBwb3NpdGlvbi5vZmZzZXRYIDogcG9zaXRpb24uY2xpZW50WCAtIHJlY3QubGVmdDtcbiAgY29uc3QgeSA9ICdvZmZzZXRZJyBpbiBwb3NpdGlvbiA/IHBvc2l0aW9uLm9mZnNldFk6IHBvc2l0aW9uLmNsaWVudFkgLSByZWN0LnRvcDtcbiAgcmV0dXJuIHsgeCwgeSB9O1xufVxuIiwiaW1wb3J0IHsgTW91c2UsIFBvaW50IH0gZnJvbSAnLi9tb3VzZSc7XG5pbXBvcnQgKiBhcyBDb25zdGFudHMgZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0ICogYXMgUGl4ZWxzIGZyb20gJy4vcGl4ZWxzJztcbmltcG9ydCB7IEF0cmFtZW50RXZlbnRUYXJnZXQgfSBmcm9tICcuL2V2ZW50cyc7XG5pbXBvcnQgeyBDb2xvclBpeGVsUkdCQSB9IGZyb20gJy4vcGl4ZWxzJztcbmltcG9ydCB7IGluY2x1ZGVzLCB1bnBhY2tPZmZzZXRYWSB9IGZyb20gJy4vdXRpbHMnO1xuXG5cbmVudW0gRHJhd2luZ01vZGUge1xuICBEUkFXID0gJ2RyYXcnLFxuICBFUkFTRSA9ICdlcmFzZScsXG4gIEZJTEwgPSAnZmlsbCcsXG4gIERJU0FCTEVEID0gJ2Rpc2FibGVkJyxcbn1cblxuY29uc3QgUGF0aERyYXdpbmdNb2RlcyA9IFtEcmF3aW5nTW9kZS5EUkFXLCBEcmF3aW5nTW9kZS5FUkFTRV07XG5cbnR5cGUgQXRyYW1lbnRDb25maWcgPSB7XG4gIHdpZHRoPzogbnVtYmVyXG4gIGhlaWdodD86IG51bWJlclxuICBjb2xvcj86IHN0cmluZ1xuICB3ZWlnaHQ/OiBudW1iZXJcbiAgc21vb3RoaW5nPzogbnVtYmVyXG4gIGFkYXB0aXZlU3Ryb2tlPzogYm9vbGVhblxuICBtb2RlPzogRHJhd2luZ01vZGVcbn1cblxuXG5jbGFzcyBBdHJhbWVudCBleHRlbmRzIEF0cmFtZW50RXZlbnRUYXJnZXQge1xuXG4gIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQ7XG4gIG1vdXNlOiBNb3VzZTtcblxuICBwcml2YXRlIGNvbnRleHQ6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRDtcbiAgcHJpdmF0ZSBfZmlsbGluZzogYm9vbGVhbjtcbiAgcHJpdmF0ZSBfZmlsbFN0YWNrOiBbbnVtYmVyLCBudW1iZXIsIENvbG9yUGl4ZWxSR0JBXVtdO1xuICByZWNvcmRTdHJva2VzOiBib29sZWFuO1xuICBzdHJva2VUaW1lc3RhbXA6IG51bWJlcjtcbiAgc3Ryb2tlTWVtb3J5OiB7IHBvaW50OiBQb2ludCwgdGltZTogbnVtYmVyIH1bXTtcblxuICBwcml2YXRlIF9kaXJ0eTogYm9vbGVhbjtcbiAgcHJpdmF0ZSBzbW9vdGhpbmc6IG51bWJlcjtcbiAgcHJpdmF0ZSBfdGhpY2tuZXNzOiBudW1iZXI7XG4gIHByaXZhdGUgX3RhcmdldFRoaWNrbmVzczogbnVtYmVyO1xuICBwcml2YXRlIF93ZWlnaHQ6IG51bWJlcjtcbiAgcHJpdmF0ZSBfbWF4V2VpZ2h0OiBudW1iZXI7XG5cbiAgcHVibGljIGRlc3Ryb3k6ICgpID0+IHZvaWQ7XG4gIF9tb2RlOiBEcmF3aW5nTW9kZTtcbiAgYWRhcHRpdmVTdHJva2U6IGJvb2xlYW47XG5cblxuICBjb25zdHJ1Y3RvcihzZWxlY3Rvcjogc3RyaW5nIHwgSFRNTENhbnZhc0VsZW1lbnQsIGNvbmZpZzogQXRyYW1lbnRDb25maWcgPSB7fSkge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdMb29rcyBsaWtlIHdlXFwncmUgbm90IHJ1bm5pbmcgaW4gYSBicm93c2VyJyk7XG4gICAgfVxuXG4gICAgc3VwZXIoKTtcblxuICAgIC8vIGdldCBjYW52YXMgZWxlbWVudFxuICAgIGlmIChzZWxlY3RvciBpbnN0YW5jZW9mIHdpbmRvdy5Ob2RlICYmIHNlbGVjdG9yLnRhZ05hbWUgPT09ICdDQU5WQVMnKSB0aGlzLmNhbnZhcyA9IHNlbGVjdG9yO1xuICAgIGVsc2UgaWYgKHR5cGVvZiBzZWxlY3RvciA9PT0gJ3N0cmluZycpIHRoaXMuY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gICAgZWxzZSB0aHJvdyBuZXcgRXJyb3IoYGNhbid0IGxvb2sgZm9yIGNhbnZhcyBiYXNlZCBvbiAnJHtzZWxlY3Rvcn0nYCk7XG4gICAgaWYgKCF0aGlzLmNhbnZhcykgdGhyb3cgbmV3IEVycm9yKCdjYW52YXMgbm90IGZvdW5kJyk7XG5cbiAgICAvLyBzZXQgZXh0ZXJuYWwgY2FudmFzIHBhcmFtc1xuICAgIHRoaXMuY2FudmFzLndpZHRoID0gY29uZmlnLndpZHRoIHx8IHRoaXMuY2FudmFzLndpZHRoO1xuICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IGNvbmZpZy5oZWlnaHQgfHwgdGhpcy5jYW52YXMuaGVpZ2h0O1xuXG4gICAgLy8gY3JlYXRlIGEgbW91c2Ugb2JqZWN0XG4gICAgdGhpcy5tb3VzZSA9IG5ldyBNb3VzZSgpO1xuXG4gICAgLy8gbW91c2Vtb3ZlIGhhbmRsZXJcbiAgICBjb25zdCBtb3VzZU1vdmUgPSAoZXZlbnQ6IE1vdXNlRXZlbnQgfCBUb3VjaEV2ZW50KSA9PiB7XG4gICAgICBpZiAoZXZlbnQuY2FuY2VsYWJsZSkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCByZWN0ID0gdGhpcy5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICBjb25zdCB7IHgsIHkgfSA9IHVucGFja09mZnNldFhZKGV2ZW50LCByZWN0KTtcblxuICAgICAgY29uc3QgeyBtb3VzZSB9ID0gdGhpcztcbiAgICAgIC8vIGRyYXcgaWYgd2Ugc2hvdWxkIGRyYXdcbiAgICAgIGlmIChtb3VzZS5kb3duICYmIGluY2x1ZGVzKFBhdGhEcmF3aW5nTW9kZXMsIHRoaXMubW9kZSkpIHtcbiAgICAgICAgY29uc3QgeyB4OiBuZXdYLCB5OiBuZXdZIH0gPSB0aGlzLmRyYXcoeCwgeSwgbW91c2UucHJldmlvdXMueCwgbW91c2UucHJldmlvdXMueSk7XG5cbiAgICAgICAgaWYgKCF0aGlzLl9kaXJ0eSAmJiB0aGlzLm1vZGUgPT09IERyYXdpbmdNb2RlLkRSQVcgJiYgKHggIT09IG1vdXNlLnggfHwgeSAhPT0gbW91c2UueSkpIHtcbiAgICAgICAgICB0aGlzLl9kaXJ0eSA9IHRydWU7XG4gICAgICAgICAgdGhpcy5maXJlRGlydHkoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG1vdXNlLnNldCh4LCB5KTtcbiAgICAgICAgbW91c2UucHJldmlvdXMuc2V0KG5ld1gsIG5ld1kpO1xuICAgICAgfVxuIGVsc2Uge1xuICAgICAgICBtb3VzZS5zZXQoeCwgeSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8vIG1vdXNlZG93biBoYW5kbGVyXG4gICAgY29uc3QgbW91c2VEb3duID0gKGV2ZW50OiBNb3VzZUV2ZW50IHwgVG91Y2hFdmVudCkgPT4ge1xuICAgICAgaWYgKGV2ZW50LmNhbmNlbGFibGUpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cbiAgICAgIC8vIHVwZGF0ZSBwb3NpdGlvbiBqdXN0IGluIGNhc2VcbiAgICAgIG1vdXNlTW92ZShldmVudCk7XG5cbiAgICAgIC8vIGlmIHdlIGFyZSBmaWxsaW5nIC0gZmlsbCBhbmQgcmV0dXJuXG4gICAgICBpZiAodGhpcy5tb2RlID09PSBEcmF3aW5nTW9kZS5GSUxMKSB7XG4gICAgICAgIHRoaXMuZmlsbCgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAvLyByZW1lbWJlciBpdFxuICAgICAgY29uc3QgeyBtb3VzZSB9ID0gdGhpcztcbiAgICAgIG1vdXNlLnByZXZpb3VzLnNldChtb3VzZS54LCBtb3VzZS55KTtcbiAgICAgIG1vdXNlLmRvd24gPSB0cnVlO1xuXG4gICAgICB0aGlzLmJlZ2luU3Ryb2tlKG1vdXNlLnByZXZpb3VzLngsIG1vdXNlLnByZXZpb3VzLnkpO1xuICAgIH07XG5cbiAgICBjb25zdCBtb3VzZVVwID0gKGV2ZW50OiBNb3VzZUV2ZW50IHwgVG91Y2hFdmVudCkgPT4ge1xuICAgICAgaWYgKHRoaXMubW9kZSA9PT0gRHJhd2luZ01vZGUuRklMTCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHsgbW91c2UgfSA9IHRoaXM7XG5cbiAgICAgIGlmICghbW91c2UuZG93bikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlY3QgPSB0aGlzLmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIGNvbnN0IHsgeCwgeSB9ID0gdW5wYWNrT2Zmc2V0WFkoZXZlbnQsIHJlY3QpO1xuICAgICAgbW91c2UuZG93biA9IGZhbHNlO1xuXG4gICAgICBpZiAobW91c2UueCA9PT0geCAmJiBtb3VzZS55ID09PSB5ICYmIGluY2x1ZGVzKFBhdGhEcmF3aW5nTW9kZXMsIHRoaXMubW9kZSkpIHtcbiAgICAgICAgY29uc3QgeyB4OiBueCwgeTogbnkgfSA9IHRoaXMuZHJhdyhtb3VzZS54LCBtb3VzZS55LCBtb3VzZS5wcmV2aW91cy54LCBtb3VzZS5wcmV2aW91cy55KTtcbiAgICAgICAgbW91c2UucHJldmlvdXMuc2V0KG54LCBueSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZW5kU3Ryb2tlKG1vdXNlLngsIG1vdXNlLnkpO1xuICAgIH07XG5cbiAgICAvLyBhdHRhY2ggbGlzdGVuZXJzXG4gICAgdGhpcy5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgbW91c2VNb3ZlKTtcbiAgICB0aGlzLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBtb3VzZURvd24pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBtb3VzZVVwKTtcbiAgICB0aGlzLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgbW91c2VEb3duKTtcbiAgICB0aGlzLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIG1vdXNlVXApO1xuICAgIHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIG1vdXNlTW92ZSk7XG5cbiAgICAvLyBoZWxwZXIgZm9yIGRlc3Ryb3lpbmcgQXRyYW1lbnQgKHJlbW92aW5nIGV2ZW50IGxpc3RlbmVycylcbiAgICB0aGlzLmRlc3Ryb3kgPSAoKSA9PiB7XG4gICAgICB0aGlzLmNsZWFyKCk7XG4gICAgICB0aGlzLmNhbnZhcy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBtb3VzZU1vdmUpO1xuICAgICAgdGhpcy5jYW52YXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgbW91c2VEb3duKTtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBtb3VzZVVwKTtcbiAgICAgIHRoaXMuY2FudmFzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBtb3VzZURvd24pO1xuICAgICAgdGhpcy5jYW52YXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBtb3VzZVVwKTtcbiAgICAgIHRoaXMuY2FudmFzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIG1vdXNlTW92ZSk7XG4gICAgfTtcblxuICAgIC8vIHNldCBpbnRlcm5hbCBjYW52YXMgcGFyYW1zXG4gICAgdGhpcy5jb250ZXh0ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICB0aGlzLmNvbnRleHQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gJ3NvdXJjZS1vdmVyJztcbiAgICB0aGlzLmNvbnRleHQuZ2xvYmFsQWxwaGEgPSAxO1xuICAgIHRoaXMuY29udGV4dC5zdHJva2VTdHlsZSA9IGNvbmZpZy5jb2xvciB8fCAncmdiYSgwLDAsMCwxKSc7XG4gICAgdGhpcy5jb250ZXh0LmxpbmVDYXAgPSAncm91bmQnO1xuICAgIHRoaXMuY29udGV4dC5saW5lSm9pbiA9ICdyb3VuZCc7XG4gICAgdGhpcy5jb250ZXh0LnRyYW5zbGF0ZSgwLjUsIDAuNSk7XG5cbiAgICB0aGlzLl9maWxsaW5nID0gZmFsc2U7XG4gICAgdGhpcy5fZmlsbFN0YWNrID0gW107XG5cbiAgICAvLyBzZXQgZHJhd2luZyBwYXJhbXNcbiAgICB0aGlzLnJlY29yZFN0cm9rZXMgPSBmYWxzZTtcbiAgICB0aGlzLnN0cm9rZU1lbW9yeSA9IFtdO1xuXG4gICAgdGhpcy5zbW9vdGhpbmcgPSBDb25zdGFudHMuaW5pdGlhbFNtb290aGluZ0ZhY3RvcjtcbiAgICB0aGlzLl90aGlja25lc3MgPSBDb25zdGFudHMuaW5pdGlhbFRoaWNrbmVzcztcbiAgICB0aGlzLl90YXJnZXRUaGlja25lc3MgPSB0aGlzLl90aGlja25lc3M7XG4gICAgdGhpcy5fd2VpZ2h0ID0gdGhpcy5fdGhpY2tuZXNzO1xuICAgIHRoaXMuX21heFdlaWdodCA9IHRoaXMuX3RoaWNrbmVzcyArIENvbnN0YW50cy53ZWlnaHRTcHJlYWQ7XG5cbiAgICB0aGlzLl9tb2RlID0gRHJhd2luZ01vZGUuRFJBVztcbiAgICB0aGlzLmFkYXB0aXZlU3Ryb2tlID0gdHJ1ZTtcblxuICAgIGlmIChjb25maWcud2VpZ2h0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMud2VpZ2h0ID0gY29uZmlnLndlaWdodDtcbiAgICB9XG4gICAgaWYgKGNvbmZpZy5zbW9vdGhpbmcgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5zbW9vdGhpbmcgPSBjb25maWcuc21vb3RoaW5nO1xuICAgIH1cbiAgICBpZiAoY29uZmlnLmFkYXB0aXZlU3Ryb2tlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuYWRhcHRpdmVTdHJva2UgPSBjb25maWcuYWRhcHRpdmVTdHJva2U7XG4gICAgfVxuICAgIGlmIChjb25maWcubW9kZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLm1vZGUgPSBjb25maWcubW9kZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQmVnaW5zIGEgc3Ryb2tlIGF0IGEgZ2l2ZW4gcG9zaXRpb25cbiAgICpcbiAgICogQHBhcmFtIHtudW1iZXJ9IHhcbiAgICogQHBhcmFtIHtudW1iZXJ9IHlcbiAgICovXG4gIGJlZ2luU3Ryb2tlKHg6IG51bWJlciwgeTogbnVtYmVyKSB7XG4gICAgdGhpcy5jb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgIHRoaXMuY29udGV4dC5tb3ZlVG8oeCwgeSk7XG5cbiAgICBpZiAodGhpcy5yZWNvcmRTdHJva2VzKSB7XG4gICAgICB0aGlzLnN0cm9rZVRpbWVzdGFtcCA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgdGhpcy5zdHJva2VNZW1vcnkucHVzaCh7IHBvaW50OiBuZXcgUG9pbnQoeCwgeSksIHRpbWU6IHBlcmZvcm1hbmNlLm5vdygpIC0gdGhpcy5zdHJva2VUaW1lc3RhbXAgfSk7XG4gICAgfVxuICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgnc3Ryb2tlc3RhcnQnLCB7IHgsIHkgfSk7XG4gIH1cblxuICAvKipcbiAgICogRW5kcyBhIHN0cm9rZSBhdCBhIGdpdmVuIHBvc2l0aW9uXG4gICAqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqL1xuICBlbmRTdHJva2UoeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcbiAgICB0aGlzLmNvbnRleHQuY2xvc2VQYXRoKCk7XG5cbiAgICBpZiAodGhpcy5yZWNvcmRTdHJva2VzKSB7XG4gICAgICB0aGlzLnN0cm9rZU1lbW9yeS5wdXNoKHsgcG9pbnQ6IG5ldyBQb2ludCh4LCB5KSwgdGltZTogcGVyZm9ybWFuY2Uubm93KCkgLSB0aGlzLnN0cm9rZVRpbWVzdGFtcCB9KTtcbiAgICB9XG4gICAgdGhpcy5kaXNwYXRjaEV2ZW50KCdzdHJva2VlbmQnLCB7IHgsIHkgfSk7XG5cbiAgICBpZiAodGhpcy5yZWNvcmRTdHJva2VzKSB7XG4gICAgICBjb25zdCBzdHJva2UgPSB7XG4gICAgICAgIHBvaW50czogdGhpcy5zdHJva2VNZW1vcnkuc2xpY2UoKSxcbiAgICAgICAgbW9kZTogdGhpcy5tb2RlLFxuICAgICAgICB3ZWlnaHQ6IHRoaXMud2VpZ2h0LFxuICAgICAgICBzbW9vdGhpbmc6IHRoaXMuc21vb3RoaW5nLFxuICAgICAgICBjb2xvcjogdGhpcy5jb2xvcixcbiAgICAgICAgYWRhcHRpdmVTdHJva2U6IHRoaXMuYWRhcHRpdmVTdHJva2VcbiAgICAgIH07XG5cbiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgnc3Ryb2tlcmVjb3JkZWQnLCB7IHN0cm9rZSB9KTtcbiAgICB9XG4gICAgdGhpcy5zdHJva2VNZW1vcnkgPSBbXTtcbiAgICBkZWxldGUgKHRoaXMuc3Ryb2tlVGltZXN0YW1wKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEcmF3cyBhIHNtb290aCBxdWFkcmF0aWMgY3VydmUgd2l0aCBhZGFwdGl2ZSBzdHJva2UgdGhpY2tuZXNzXG4gICAqIGJldHdlZW4gdHdvIHBvaW50c1xuICAgKlxuICAgKiBAcGFyYW0ge251bWJlcn0geCBjdXJyZW50IFggY29vcmRpbmF0ZVxuICAgKiBAcGFyYW0ge251bWJlcn0geSBjdXJyZW50IFkgY29vcmRpbmF0ZVxuICAgKiBAcGFyYW0ge251bWJlcn0gcHJldlggcHJldmlvdXMgWCBjb29yZGluYXRlXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBwcmV2WSBwcmV2aW91cyBZIGNvb3JkaW5hdGVcbiAgICovXG4gIGRyYXcoeDogbnVtYmVyLCB5OiBudW1iZXIsIHByZXZYOiBudW1iZXIsIHByZXZZOiBudW1iZXIpIHtcbiAgICBpZiAodGhpcy5yZWNvcmRTdHJva2VzKSB7XG4gICAgICB0aGlzLnN0cm9rZU1lbW9yeS5wdXNoKHsgcG9pbnQ6IG5ldyBQb2ludCh4LCB5KSwgdGltZTogcGVyZm9ybWFuY2Uubm93KCkgLSB0aGlzLnN0cm9rZVRpbWVzdGFtcCB9KTtcbiAgICB9XG5cbiAgICBjb25zdCB7IGNvbnRleHQgfSA9IHRoaXM7XG4gICAgLy8gY2FsY3VsYXRlIGRpc3RhbmNlIGZyb20gcHJldmlvdXMgcG9pbnRcbiAgICBjb25zdCByYXdEaXN0ID0gUGl4ZWxzLmxpbmVEaXN0YW5jZSh4LCB5LCBwcmV2WCwgcHJldlkpO1xuXG4gICAgLy8gbm93LCBoZXJlIHdlIHNjYWxlIHRoZSBpbml0aWFsIHNtb290aGluZyBmYWN0b3IgYnkgdGhlIHJhdyBkaXN0YW5jZVxuICAgIC8vIHRoaXMgbWVhbnMgdGhhdCB3aGVuIHRoZSBtb3VzZSBtb3ZlcyBmYXN0LCB0aGVyZSBpcyBtb3JlIHNtb290aGluZ1xuICAgIC8vIGFuZCB3aGVuIHdlJ3JlIGRyYXdpbmcgc21hbGwgZGV0YWlsZWQgc3R1ZmYsIHdlIGhhdmUgbW9yZSBjb250cm9sXG4gICAgLy8gYWxzbyB3ZSBoYXJkIGNsaXAgYXQgMVxuICAgIGNvbnN0IHNtb290aGluZ0ZhY3RvciA9IE1hdGgubWluKENvbnN0YW50cy5taW5TbW9vdGhpbmdGYWN0b3IsIHRoaXMuc21vb3RoaW5nICsgKHJhd0Rpc3QgLSA2MCkgLyAzMDAwKTtcblxuICAgIC8vIGNhbGN1bGF0ZSBwcm9jZXNzZWQgY29vcmRpbmF0ZXNcbiAgICBjb25zdCBwcm9jWCA9IHggLSAoeCAtIHByZXZYKSAqIHNtb290aGluZ0ZhY3RvcjtcbiAgICBjb25zdCBwcm9jWSA9IHkgLSAoeSAtIHByZXZZKSAqIHNtb290aGluZ0ZhY3RvcjtcblxuICAgIC8vIHJlY2FsY3VsYXRlIGRpc3RhbmNlIGZyb20gcHJldmlvdXMgcG9pbnQsIHRoaXMgdGltZSByZWxhdGl2ZSB0byB0aGUgc21vb3RoZWQgY29vcmRzXG4gICAgY29uc3QgZGlzdCA9IFBpeGVscy5saW5lRGlzdGFuY2UocHJvY1gsIHByb2NZLCBwcmV2WCwgcHJldlkpO1xuXG4gICAgaWYgKHRoaXMuYWRhcHRpdmVTdHJva2UpIHtcbiAgICAgIC8vIGNhbGN1bGF0ZSB0YXJnZXQgdGhpY2tuZXNzIGJhc2VkIG9uIHRoZSBuZXcgZGlzdGFuY2VcbiAgICAgIHRoaXMuX3RhcmdldFRoaWNrbmVzcyA9IChkaXN0IC0gQ29uc3RhbnRzLm1pbkxpbmVUaGlja25lc3MpXG4gICAgICAgIC8gQ29uc3RhbnRzLmxpbmVUaGlja25lc3NSYW5nZSAqICh0aGlzLl9tYXhXZWlnaHQgLSB0aGlzLl93ZWlnaHQpICsgdGhpcy5fd2VpZ2h0O1xuICAgICAgLy8gYXBwcm9hY2ggdGhlIHRhcmdldCBncmFkdWFsbHlcbiAgICAgIGlmICh0aGlzLl90aGlja25lc3MgPiB0aGlzLl90YXJnZXRUaGlja25lc3MpIHtcbiAgICAgICAgdGhpcy5fdGhpY2tuZXNzIC09IENvbnN0YW50cy50aGlja25lc3NJbmNyZW1lbnQ7XG4gICAgICB9XG4gICAgICBlbHNlIGlmICh0aGlzLl90aGlja25lc3MgPCB0aGlzLl90YXJnZXRUaGlja25lc3MpIHtcbiAgICAgICAgdGhpcy5fdGhpY2tuZXNzICs9IENvbnN0YW50cy50aGlja25lc3NJbmNyZW1lbnQ7XG4gICAgICB9XG4gICAgICAvLyBzZXQgbGluZSB3aWR0aFxuICAgICAgY29udGV4dC5saW5lV2lkdGggPSB0aGlzLl90aGlja25lc3M7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgLy8gbGluZSB3aWR0aCBpcyBlcXVhbCB0byBkZWZhdWx0IHdlaWdodFxuICAgICAgY29udGV4dC5saW5lV2lkdGggPSB0aGlzLl93ZWlnaHQ7XG4gICAgfVxuXG4gICAgLy8gZHJhdyB1c2luZyBxdWFkIGludGVycG9sYXRpb25cbiAgICBjb250ZXh0LnF1YWRyYXRpY0N1cnZlVG8ocHJldlgsIHByZXZZLCBwcm9jWCwgcHJvY1kpO1xuICAgIGNvbnRleHQuc3Ryb2tlKCk7XG5cbiAgICByZXR1cm4geyB4OiBwcm9jWCwgeTogcHJvY1kgfTtcbiAgfVxuXG4gIGdldCBjb2xvcigpIHtcbiAgICByZXR1cm4gdGhpcy5jb250ZXh0LnN0cm9rZVN0eWxlLnRvU3RyaW5nKCk7XG4gIH1cblxuICBzZXQgY29sb3IoYykge1xuICAgIGlmICh0eXBlb2YgYyAhPT0gJ3N0cmluZycpIHRocm93IG5ldyBFcnJvcignd3JvbmcgYXJndW1lbnQgdHlwZScpO1xuICAgIHRoaXMuY29udGV4dC5zdHJva2VTdHlsZSA9IGM7XG4gIH1cblxuICBnZXQgd2VpZ2h0KCkge1xuICAgIHJldHVybiB0aGlzLl93ZWlnaHQ7XG4gIH1cblxuICBzZXQgd2VpZ2h0KHcpIHtcbiAgICBpZiAodHlwZW9mIHcgIT09ICdudW1iZXInKSB0aHJvdyBuZXcgRXJyb3IoJ3dyb25nIGFyZ3VtZW50IHR5cGUnKTtcbiAgICB0aGlzLl93ZWlnaHQgPSB3O1xuICAgIHRoaXMuX3RoaWNrbmVzcyA9IHc7XG4gICAgdGhpcy5fdGFyZ2V0VGhpY2tuZXNzID0gdztcbiAgICB0aGlzLl9tYXhXZWlnaHQgPSB3ICsgQ29uc3RhbnRzLndlaWdodFNwcmVhZDtcbiAgfVxuXG4gIGdldCBtb2RlKCkge1xuICAgIHJldHVybiB0aGlzLl9tb2RlO1xuICB9XG5cbiAgc2V0IG1vZGUobSkge1xuICAgIGlmICh0eXBlb2YgbSAhPT0gJ3N0cmluZycpIHRocm93IG5ldyBFcnJvcignd3JvbmcgYXJndW1lbnQgdHlwZScpO1xuICAgIHN3aXRjaCAobSkge1xuICAgICAgY2FzZSBEcmF3aW5nTW9kZS5FUkFTRTpcbiAgICAgICAgdGhpcy5fbW9kZSA9IERyYXdpbmdNb2RlLkVSQVNFO1xuICAgICAgICB0aGlzLmNvbnRleHQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gJ2Rlc3RpbmF0aW9uLW91dCc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBEcmF3aW5nTW9kZS5GSUxMOlxuICAgICAgICB0aGlzLl9tb2RlID0gRHJhd2luZ01vZGUuRklMTDtcbiAgICAgICAgdGhpcy5jb250ZXh0Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICdzb3VyY2Utb3Zlcic7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBEcmF3aW5nTW9kZS5ESVNBQkxFRDpcbiAgICAgICAgdGhpcy5fbW9kZSA9IERyYXdpbmdNb2RlLkRJU0FCTEVEO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRoaXMuX21vZGUgPSBEcmF3aW5nTW9kZS5EUkFXO1xuICAgICAgICB0aGlzLmNvbnRleHQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gJ3NvdXJjZS1vdmVyJztcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgaXNEaXJ0eSgpIHtcbiAgICByZXR1cm4gISF0aGlzLl9kaXJ0eTtcbiAgfVxuXG4gIGZpcmVEaXJ0eSgpIHtcbiAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ2RpcnR5Jyk7XG4gIH1cblxuICBjbGVhcigpIHtcbiAgICBpZiAoIXRoaXMuaXNEaXJ0eSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuX2RpcnR5ID0gZmFsc2U7XG4gICAgdGhpcy5kaXNwYXRjaEV2ZW50KCdjbGVhbicpO1xuXG4gICAgLy8gbWFrZSBzdXJlIHdlJ3JlIGluIHRoZSByaWdodCBjb21wb3NpdGluZyBtb2RlLCBhbmQgZXJhc2UgZXZlcnl0aGluZ1xuICAgIGlmICh0aGlzLm1vZGUgPT09IERyYXdpbmdNb2RlLkVSQVNFKSB7XG4gICAgICB0aGlzLm1vZGUgPSBEcmF3aW5nTW9kZS5EUkFXO1xuICAgICAgdGhpcy5jb250ZXh0LmNsZWFyUmVjdCgtMTAsIC0xMCwgdGhpcy5jYW52YXMud2lkdGggKyAyMCwgdGhpcy5jYW52YXMuaGVpZ2h0ICsgMjApO1xuICAgICAgdGhpcy5tb2RlID0gRHJhd2luZ01vZGUuRVJBU0U7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy5jb250ZXh0LmNsZWFyUmVjdCgtMTAsIC0xMCwgdGhpcy5jYW52YXMud2lkdGggKyAyMCwgdGhpcy5jYW52YXMuaGVpZ2h0ICsgMjApO1xuICAgIH1cbiAgfVxuXG4gIHRvSW1hZ2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2FudmFzLnRvRGF0YVVSTCgpO1xuICB9XG5cbiAgZmlsbCgpIHtcbiAgICBjb25zdCB7IG1vdXNlIH0gPSB0aGlzO1xuICAgIGNvbnN0IHsgY29udGV4dCB9ID0gdGhpcztcbiAgICAvLyBjb252ZXJ0aW5nIHRvIEFycmF5IGJlY2F1c2UgU2FmYXJpIDlcbiAgICBjb25zdCBzdGFydENvbG9yID0gQXJyYXkuZnJvbShjb250ZXh0LmdldEltYWdlRGF0YShtb3VzZS54LCBtb3VzZS55LCAxLCAxKS5kYXRhKSBhcyBDb2xvclBpeGVsUkdCQTtcbiAgICBpZiAoc3RhcnRDb2xvci5sZW5ndGggIT09IDQpIHRocm93IG5ldyBFcnJvcignRXhwZWN0IHBpeGVsIGZvcm1hdCBvZiBSR0JBJyk7XG5cbiAgICBpZiAoIXRoaXMuX2ZpbGxpbmcpIHtcbiAgICAgIGNvbnN0IHsgeCwgeSB9ID0gbW91c2U7XG4gICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ2ZpbGxzdGFydCcsIHsgeCwgeSB9KTtcbiAgICAgIHRoaXMuX2ZpbGxpbmcgPSB0cnVlO1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7IHRoaXMuX2Zsb29kRmlsbChtb3VzZS54LCBtb3VzZS55LCBzdGFydENvbG9yKTsgfSwgQ29uc3RhbnRzLmZsb29kRmlsbEludGVydmFsKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aGlzLl9maWxsU3RhY2sucHVzaChbXG4gICAgICAgIG1vdXNlLngsXG4gICAgICAgIG1vdXNlLnksXG4gICAgICAgIHN0YXJ0Q29sb3JcbiAgICAgIF0pO1xuICAgIH1cbiAgfVxuXG4gIF9mbG9vZEZpbGwoX3N0YXJ0WDogbnVtYmVyLCBfc3RhcnRZOiBudW1iZXIsIHN0YXJ0Q29sb3I6IENvbG9yUGl4ZWxSR0JBKSB7XG4gICAgY29uc3QgeyBjb250ZXh0IH0gPSB0aGlzO1xuICAgIGNvbnN0IHN0YXJ0WCA9IE1hdGguZmxvb3IoX3N0YXJ0WCk7XG4gICAgY29uc3Qgc3RhcnRZID0gTWF0aC5mbG9vcihfc3RhcnRZKTtcbiAgICBjb25zdCBjYW52YXNXaWR0aCA9IGNvbnRleHQuY2FudmFzLndpZHRoO1xuICAgIGNvbnN0IGNhbnZhc0hlaWdodCA9IGNvbnRleHQuY2FudmFzLmhlaWdodDtcbiAgICBjb25zdCBwaXhlbFN0YWNrID0gW1tzdGFydFgsIHN0YXJ0WV1dO1xuXG4gICAgLy8gaGV4IG5lZWRzIHRvIGJlIHRyYXNmb3JtZWQgdG8gcmdiIHNpbmNlIGNvbG9yTGF5ZXIgYWNjZXB0cyBSR0JcbiAgICBjb25zdCBmaWxsQ29sb3IgPSBQaXhlbHMuaGV4VG9SZ2IodGhpcy5jb2xvcik7XG5cbiAgICAvLyBOZWVkIHRvIHNhdmUgY3VycmVudCBjb250ZXh0IHdpdGggY29sb3JzLCB3ZSB3aWxsIHVwZGF0ZSBpdFxuICAgIGNvbnN0IGNvbG9yTGF5ZXIgPSBjb250ZXh0LmdldEltYWdlRGF0YSgwLCAwLCBjb250ZXh0LmNhbnZhcy53aWR0aCwgY29udGV4dC5jYW52YXMuaGVpZ2h0KTtcblxuICAgIGNvbnN0IGNvbG9yTGF5ZXJEYXRhID0gQXJyYXkuZnJvbShjb2xvckxheWVyLmRhdGEpO1xuICAgIGNvbnN0IGFscGhhID0gTWF0aC5taW4oY29udGV4dC5nbG9iYWxBbHBoYSAqIDEwICogMjU1LCAyNTUpO1xuICAgIGNvbnN0IGNvbG9yUGl4ZWwgPSBQaXhlbHMuY29sb3JQaXhlbChjb2xvckxheWVyRGF0YSwgLi4uZmlsbENvbG9yLCBzdGFydENvbG9yLCBhbHBoYSk7XG4gICAgY29uc3QgbWF0Y2hDb2xvciA9IFBpeGVscy5tYXRjaENvbG9yKGNvbG9yTGF5ZXJEYXRhLCAuLi5zdGFydENvbG9yKTtcbiAgICBjb25zdCBtYXRjaEZpbGxDb2xvciA9IFBpeGVscy5tYXRjaENvbG9yKGNvbG9yTGF5ZXJEYXRhLCAuLi5maWxsQ29sb3IsIDI1NSk7XG5cbiAgICAvLyBjaGVjayBpZiB3ZSdyZSB0cnlpbmcgdG8gZmlsbCB3aXRoIHRoZSBzYW1lIGNvbG91ciwgaWYgc28sIHN0b3BcbiAgICBpZiAobWF0Y2hGaWxsQ29sb3IoKHN0YXJ0WSAqIGNvbnRleHQuY2FudmFzLndpZHRoICsgc3RhcnRYKSAqIDQpKSB7XG4gICAgICB0aGlzLl9maWxsaW5nID0gZmFsc2U7XG4gICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ2ZpbGxlbmQnLCB7fSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgd2hpbGUgKHBpeGVsU3RhY2subGVuZ3RoKSB7XG4gICAgICBjb25zdCBuZXdQb3MgPSBwaXhlbFN0YWNrLnBvcCgpO1xuICAgICAgY29uc3QgeCA9IG5ld1Bvc1swXTtcbiAgICAgIGxldCB5ID0gbmV3UG9zWzFdO1xuXG4gICAgICBsZXQgcGl4ZWxQb3MgPSAoeSAqIGNhbnZhc1dpZHRoICsgeCkgKiA0O1xuXG4gICAgICB3aGlsZSAoeS0tID49IDAgJiYgbWF0Y2hDb2xvcihwaXhlbFBvcykpIHtcbiAgICAgICAgcGl4ZWxQb3MgLT0gY2FudmFzV2lkdGggKiA0O1xuICAgICAgfVxuICAgICAgcGl4ZWxQb3MgKz0gY2FudmFzV2lkdGggKiA0O1xuXG4gICAgICArK3k7XG5cbiAgICAgIGxldCByZWFjaExlZnQgPSBmYWxzZTtcbiAgICAgIGxldCByZWFjaFJpZ2h0ID0gZmFsc2U7XG5cbiAgICAgIHdoaWxlICh5KysgPCBjYW52YXNIZWlnaHQgLSAxICYmIG1hdGNoQ29sb3IocGl4ZWxQb3MpKSB7XG4gICAgICAgIGNvbG9yUGl4ZWwocGl4ZWxQb3MpO1xuXG4gICAgICAgIGlmICh4ID4gMCkge1xuICAgICAgICAgIGlmIChtYXRjaENvbG9yKHBpeGVsUG9zIC0gNCkpIHtcbiAgICAgICAgICAgIGlmICghcmVhY2hMZWZ0KSB7XG4gICAgICAgICAgICAgIHBpeGVsU3RhY2sucHVzaChbeCAtIDEsIHldKTtcbiAgICAgICAgICAgICAgcmVhY2hMZWZ0ID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZiAocmVhY2hMZWZ0KSB7XG4gICAgICAgICAgICByZWFjaExlZnQgPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoeCA8IGNhbnZhc1dpZHRoIC0gMSkge1xuICAgICAgICAgIGlmIChtYXRjaENvbG9yKHBpeGVsUG9zICsgNCkpIHtcbiAgICAgICAgICAgIGlmICghcmVhY2hSaWdodCkge1xuICAgICAgICAgICAgICBwaXhlbFN0YWNrLnB1c2goW3ggKyAxLCB5XSk7XG4gICAgICAgICAgICAgIHJlYWNoUmlnaHQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmIChyZWFjaFJpZ2h0KSB7XG4gICAgICAgICAgICByZWFjaFJpZ2h0ID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcGl4ZWxQb3MgKz0gY2FudmFzV2lkdGggKiA0O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBjb250ZXh0IHdpdGggZmlsbGVkIGJ1Y2tldCFcbiAgICBjb250ZXh0LnB1dEltYWdlRGF0YShjb2xvckxheWVyLCAwLCAwKTtcblxuICAgIGlmICh0aGlzLl9maWxsU3RhY2subGVuZ3RoKSB7XG4gICAgICB0aGlzLl9mbG9vZEZpbGwoLi4udGhpcy5fZmlsbFN0YWNrLnNoaWZ0KCkpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRoaXMuX2ZpbGxpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgnZmlsbGVuZCcsIHt9KTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IHsgQXRyYW1lbnQgfTtcbiIsImV4cG9ydCB7IEF0cmFtZW50IH0gZnJvbSAnLi9zcmMvYXRyYW1lbnQnO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==